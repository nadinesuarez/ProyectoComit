<div id="busquedacentrada">
    <h1>Bienvenidx, {{nombre}}</h1>
    <h2>Busca Películas</h2>
    <label for="titulo">Título: </label>
    <input id="busqueda" type="text" />
    <button onclick="buscar()">Buscar</button>
</div>
<img id="fondohome" src="background.png">

<!-- Contenedor del resultado -->
<div id="peliculas"></div>

<script>
    //API CODE5971ce05

    //Send all data requests to:
    //http://www.omdbapi.com/?apikey=5971ce05&

    //Poster API requests:
    //http://img.omdbapi.com/?apikey=[yourkey]&

    const divPeliculas = document.getElementById("peliculas")
    const divZoomTapa = document.getElementById("zoomTapa")
    const divSombreado = document.getElementById("sombreado");

    function buscar() {
        let xhr = new XMLHttpRequest();
        xhr.onload = function () {

            if (xhr.status == 200) {
                let respuesta = JSON.parse(xhr.responseText);

                if (respuesta.Search) {
                    let peliculas = respuesta.Search;
                divPeliculas.textContent = "";


                peliculas.forEach(pelicula => {
                    divPeliculas.appendChild(crearDivPelicula(pelicula));
                    console.log ("peliculas:" + peliculas)
                });
                } else {
                divPeliculas.textContent = "No se encontraron resultados";
            }

            } else {
                divPeliculas.textContent = xhr.responseText;
            }
        }

        let filtroTitulo = document.getElementById("busqueda").value;

        // Abro conexión para request GET a la url de la API que retorna el JSON con peliculas
        xhr.open("GET", `http://www.omdbapi.com/?apikey=5971ce05&s=${filtroTitulo}`);
        // Envío el request
        xhr.send();

        // Pongo texto "Consultando datos...." para que se lea mientras espera respuesta.
        divPeliculas.textContent = "Consultando datos....";

    }


    /**
     * Función alternativa a crearDivDisco con otra forma de resolución
     * 
     * @param {Object} datospelicula idem crearDivDisco
     */
    function crearDivPelicula(datospelicula) {

        // Creo un elemento div para contener todo lo que estoy creando
        let divRespuesta = document.createElement("div");

        // Declaro una variable html y la inicializo con un string vacío
        let html = '';
        console.log ("datospeliculas:" + datospelicula)

        // Concateno valores en esa variable formando un pedazo de código HTML
        html += `<div class="contenedor-pelicula">`;
        html += `<img src="${datospelicula.poster}">`;
        html += `<ul>`;
        html += `<li>Titulo: ${datospelicula.title}</li>`;
        html += `<li>Año: ${datospelicula.year}</li>`;
        html += `<li>Tipo: ${datospelicula.type}</li>`;
        html += `</ul>`;
        html += `</div>`;

        // Asigno ese texto como HTML del div
        divRespuesta.innerHTML = html;

        // Retorno el div
        return divRespuesta;

    }
    
</script>